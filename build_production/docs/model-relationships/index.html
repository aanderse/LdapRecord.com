<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="Implementing and utilizing relationships in LdapRecord">

        <meta property="og:site_name" content="LdapRecord"/>
        <meta property="og:title" content="Model Relationships | LdapRecord"/>
        <meta property="og:description" content="Implementing and utilizing relationships in LdapRecord"/>
        <meta property="og:url" content="https://ldaprecord.com/docs/model-relationships"/>
        <meta property="og:image" content="/assets/img/logo.png"/>
        <meta property="og:type" content="website"/>

        <meta name="twitter:image:alt" content="LdapRecord">
        <meta name="twitter:card" content="summary_large_image">

                    <meta name="generator" content="tighten_jigsaw_doc">
        
        <title>LdapRecord | Model Relationships</title>

        <link rel="home" href="https://ldaprecord.com">
        <link rel="icon" href="/favicon.ico">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">

        
        <link rel="stylesheet" href="/assets/build/css/main.css?id=1fb9c770d704bcc85da2">

                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
            </head>
    <body class="bg-gray-100 antialiased font-sans">
        <nav class="flex items-center h-24 py-12 z-20 border-gradient-l-purple-light border-b-8 mb-2" role="banner">
            <div class="container flex items-center max-w-8xl mx-auto px-4 lg:px-8">
                <div class="flex items-center">
                    <a href="/" title="LdapRecord home" class="inline-flex items-center">
                        <img class="h-20 md:h-24 mr-3" src="/assets/img/logo.svg" alt="LdapRecord logo" />
                    </a>
                </div>

                <div class="flex flex-1 justify-end items-center text-right md:pl-10 text-gray-800">
                                            <button
    title="Start searching"
    type="button"
    class="flex md:hidden bg-gray-100 hover:bg-blue-100 justify-center items-center shadow rounded focus:outline-none h-10 px-3"
    onclick="searchInput.toggle()"
>
    <img src="/assets/img/magnifying-glass.svg" alt="search icon" class="h-4 w-4 max-w-none">
</button>

<div id="js-search-input" class="docsearch-input__wrapper hidden md:block">
    <label for="search" class="hidden">Search</label>

    <input
        id="docsearch-input"
        class="docsearch-input block h-10 transition-fast w-full lg:w-1/2 xl:w-1/3 outline-none rounded text-gray-700 focus:border-blue-400 ml-auto px-4 pb-0 shadow"
        name="docsearch"
        type="text"
        placeholder="Search"
    >

    <button
        class="md:hidden absolute right-0 mr-8 h-full font-light text-3xl text-blue-500 hover:text-blue-600 focus:outline-none -mt-px"
        onclick="searchInput.toggle()"
    >&times;</button>
</div>

                    
                                            
                        <a href="/docs/laravel" class="ml-6 hidden md:inline whitespace-no-wrap text-gray-800 hover:text-purple-700" title="LdapRecord-Laravel Documentation Link">
                            Laravel Docs
                        </a>

                        <a href="https://github.com/DirectoryTree/LdapRecord" class="hidden sm:inline text-gray-800 hover:text-purple-700">
                            <svg class="fill-current w-8 ml-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>GitHub</title><path d="M10 0a10 10 0 0 0-3.16 19.49c.5.1.68-.22.68-.48l-.01-1.7c-2.78.6-3.37-1.34-3.37-1.34-.46-1.16-1.11-1.47-1.11-1.47-.9-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.9 1.52 2.34 1.08 2.91.83.1-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.94 0-1.1.39-1.99 1.03-2.69a3.6 3.6 0 0 1 .1-2.64s.84-.27 2.75 1.02a9.58 9.58 0 0 1 5 0c1.91-1.3 2.75-1.02 2.75-1.02.55 1.37.2 2.4.1 2.64.64.7 1.03 1.6 1.03 2.69 0 3.84-2.34 4.68-4.57 4.93.36.31.68.92.68 1.85l-.01 2.75c0 .26.18.58.69.48A10 10 0 0 0 10 0"></path></svg>
                        </a>
                                    </div>
            </div>

                <button class="flex justify-center items-center bg-purple-500 shadow h-10 mr-4 px-5 rounded lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

        </nav>

        <main role="main" class="w-full">
            <div class="relative h-full max-w-screen-xl mx-auto">
                                    <svg style="left:100%;" width="404" height="784" fill="none" viewBox="0 0 404 784" class="absolute hidden sm:block transform translate-y-64 -translate-x-64">
                        <defs>
                            <pattern id="f210dbf6-a58d-4871-961e-36d5016a0f49" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse">
                                <rect x="0" y="0" width="4" height="4" fill="currentColor" class="text-gray-200"></rect>
                            </pattern>
                        </defs>
                        <rect width="404" height="784" fill="url(#f210dbf6-a58d-4871-961e-36d5016a0f49)"></rect>
                    </svg>
                            </div>

                <section class="container relative max-w-8xl mx-auto px-6 md:px-8 py-4">
        <div class="flex flex-col lg:flex-row">
            <nav id="js-nav-menu" class="nav-menu hidden lg:block">
                    <ul class="list-none my-0 ">
            <li class="pl-4">
            
        <p class="nav-menu__item text-gray-500 font-extrabold text-xs tracking-widest uppercase italic pt-2">Introduction</p>
    
            
        <ul class="list-none my-0 border-l-4 border-purple-200">
            <li class="pl-4">
            
        <a href="/docs/quickstart"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Quickstart
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Overview
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/installation"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Installation
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/configuration"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Configuration
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/connections"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Connections
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/searching"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Searching 
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <p class="nav-menu__item text-gray-500 font-extrabold text-xs tracking-widest uppercase italic pt-2">Models</p>
    
            
        <ul class="list-none my-0 border-l-4 border-purple-200">
            <li class="pl-4">
            
        <a href="/docs/models"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Getting Started
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/model-relationships"
            class="lvl1  active font-semibold text-purple-600 nav-menu__item hover:text-purple-500"
        >
            Relationships
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/model-mutators"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Accessors &amp; Mutators
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/model-api"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            API (Available Methods)
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <p class="nav-menu__item text-gray-500 font-extrabold text-xs tracking-widest uppercase italic pt-2">Active Directory</p>
    
            
        <ul class="list-none my-0 border-l-4 border-purple-200">
            <li class="pl-4">
            
        <a href="/docs/active-directory/users"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Users
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/active-directory/groups"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Groups
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <p class="nav-menu__item text-gray-500 font-extrabold text-xs tracking-widest uppercase italic pt-2">Other Features</p>
    
            
        <ul class="list-none my-0 border-l-4 border-purple-200">
            <li class="pl-4">
            
        <a href="/docs/authentication"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Authentication
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/common-queries"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Common Queries
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/caching"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Caching
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/events"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Events
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/logging"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Logging
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/testing"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Testing
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <p class="nav-menu__item text-gray-500 font-extrabold text-xs tracking-widest uppercase italic pt-2">Extra</p>
    
            
        <ul class="list-none my-0 border-l-4 border-purple-200">
            <li class="pl-4">
            
        <a href="/docs/versioning"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Versioning
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/credits"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            Credits
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/docs/license"
            class="lvl1  text-gray-700 nav-menu__item hover:text-purple-500"
        >
            License
        </a>
    
    </li>
    </ul>
    </li>
    </ul>

    <div class="block md:hidden">
        <hr class="my-4"/>

        <ul class="list-none my-0">
            <li class="pl-4">
                <a href="/docs/laravel/"
                   class="nav-menu__item hover:text-blue-500"
                >
                    Laravel Documentation
                </a>
            </li>

            <li class="pl-4">
                <a href="https://github.com/DirectoryTree/LdapRecord"
                   class="nav-menu__item hover:text-blue-500"
                >
                    Source Code
                </a>
            </li>
        </ul>
    </div>
            </nav>

            <div class="DocSearch-content content w-full lg:w-3/5 break-words pb-16 lg:pl-4" v-pre>
                <h1>Models: Relationships</h1>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#defining-relationships">Defining Relationships</a>

<ul>
<li><a href="#has-one">Has One</a></li>
<li><a href="#has-many">Has Many</a></li>
<li><a href="#has-many-inverse">Has Many (Inverse)</a></li>
<li><a href="#has-many-in">Has Many In</a></li>
</ul></li>
<li><a href="#querying-relationships">Querying Relationships</a>

<ul>
<li><a href="#recursive-queries">Recursive Queries</a></li>
</ul></li>
<li><a href="#attaching-amp-detatching-relationships">Attaching &amp; Detaching Relationships</a></li>
<li><a href="#checking-relationship-existence">Checking Relationship Existence</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>LDAP records often contain attributes that reference other LDAP records in your directory. An
example of this would be the <code>member</code> attribute on LDAP groups that contain a list of
distinguished names whom are members of the group.</p>

<p>Using LdapRecord relationships, we can define what models contain references to other records
and easily retrieve the referenced models to perform operations upon. There are several
relationship types that LdapRecord supports:</p>

<table>
<thead>
<tr>
  <th>Relationship</th>
  <th>Type</th>
</tr>
</thead>
<tbody>
<tr>
  <td><a href="#has-one">Has One</a></td>
  <td>Indicates a one-to-one relation, such as a user having one manager</td>
</tr>
<tr>
  <td><a href="#has-many">Has Many</a></td>
  <td>Indicates a one-to-many relation, such as a user having many groups</td>
</tr>
<tr>
  <td><a href="#has-many-inverse">Has Many (Inverse)</a></td>
  <td>Indicates an inverse one-to-many relation, such as a group having many members</td>
</tr>
<tr>
  <td><a href="#has-many-in">Has Many In</a></td>
  <td>Indicates a one-to-many relation, but with virtual attributes that cannot be modified</td>
</tr>
</tbody>
</table>

<h2 id="defining-relationships">Defining Relationships</h2>

<h3 id="has-one">Has One</h3>

<p>A has one relationship is a basic relationship to work with. An example of a "has one" relationship would be
a <code>User</code> having one <code>manager</code>. To define this relationship, we place a <code>manager()</code> method on our <code>User</code>
model, and call the <code>hasOne()</code> method and return the result:</p>

<pre><code class="language-php">&lt;?php

use LdapRecord\Models\Model;

class User extends Model
{
    /**
     * Retrieve the manager of the current user.
     */
    public function manager()
    {
        return $this-&gt;hasOne(User::class, 'manager');
    }
}
</code></pre>

<p>The first argument that is passed into the relation is the name of the related model.
The second is the LDAP attribute on the <em>current</em> user that contains the
relationships distinguished name.</p>

<p>If the relationships attribute you are defining does not contain a distinguished name,
you can alter this and define a <em>foreign key</em> using the third parameter. For example,
if our manager attribute actually contains a <code>uid</code>, we can change this so the
related model is retrieved by a UID, instead of a distinguished name:</p>

<pre><code class="language-php">&lt;?php

use LdapRecord\Models\Model;

class User extends Model
{
    /**
     * Retrieve the manager of the current user.
     */
    public function manager()
    {
        return $this-&gt;hasOne(User::class, 'manager', 'uid');
    }
}
</code></pre>

<h3 id="has-many">Has Many</h3>

<p>Defining a has many relationship indicates that the model can be apart of
many of the given model.</p>

<p>For example, a <code>User</code> "has many" <code>groups</code>:</p>

<pre><code class="language-php">&lt;?php

use LdapRecord\Models\Model;

class User extends Model
{
    /**
     * Retrieve the groups the user is apart of.
     */
    public function groups()
    {
        return $this-&gt;hasMany(Group::class, 'member');
    }
}
</code></pre>

<p>In the above example, LdapRecord will construct a query to locate all of
the groups that the user is apart of using the users distinguished name.
This users distinguished name will automatically be escaped to
be able to properly locate all of the groups.</p>

<p>For example, this is the query filter that will be used in the search:</p>

<pre><code class="language-text">(member=cn\3dJohn Doe\2cdc\3dacme\2cdc\3dorg)
</code></pre>

<p>If you're using an alternate LDAP server or a different attribute to locate
group membership, you may change the relation key. For example, you may
want to use <code>uniquemember</code> for this relationship:</p>

<pre><code class="language-php">/**                                                
 * Retrieve the groups the user is apart of.       
 */                                                
public function groups()                           
{                                                  
    return $this-&gt;hasMany(Group::class, 'uniquemember'); 
}                                                  
</code></pre>

<p>You may also define a <em>foreign key</em> in third parameter if the attribute
you are using is not a distinguished name.</p>

<h3 id="has-many-inverse">Has Many (Inverse)</h3>

<p>Now that we have setup a <code>User</code> model that can access of their groups,
lets define a <code>Group</code> model to be able to access its members.</p>

<p>Since an LDAP group can contain various types of objects (such as
contacts, users, and other groups), we must pass in an array of
models that are potential members of the group. This allows
the relationship to properly create the models that are
returned from the query results.</p>

<blockquote>
  <p>LdapRecord will return plain <code>Entry</code> models when
  it cannot locate the correct model in the given array.</p>
</blockquote>

<pre><code class="language-php">&lt;?php

use LdapRecord\Models\Model;

class Group extends Model
{
    /**
     * Retrieve the members of the group.
     */
    public function members()
    {
        return $this-&gt;hasMany([
            Group::class, User::class, Contact::class
        ], 'memberof')-&gt;using($this, 'member');
    }
}
</code></pre>

<blockquote>
  <p>For brevity, we have not shown the creation of the <code>Contact</code> model.</p>
</blockquote>

<p>You can see from the above example, we have passed an array of models
that are possible members of the group. The difference of this
definition is the usage of the <code>using()</code> method.</p>

<p>Since LDAP does not offer bi-directional relationships, we must add the
<code>using()</code> method. This method defines which model and attribute
to use for attaching and detaching related models.</p>

<p>In this case, we pass in <code>$this</code> to indicate that the current model
instance (the <code>Group</code>) contains the <code>member</code> attribute to add and
remove models you pass into the <code>attach()</code> and <code>detach()</code> methods.</p>

<p>This method is paramount to be able to properly utilize this relationship.</p>

<p>When querying the above relationship, LdapRecord will construct the following filter:</p>

<pre><code class="language-text">(memberof=cn\3dAccounting\2cdc\3dacme\2cdc\3dorg)
</code></pre>

<h3 id="has-many-in">Has Many In</h3>

<p>The has many in relationship allows you to retrieve related models from
the given parent models <a href="https://ldapwiki.com/wiki/Virtual%20Attribute">virtual attribute</a>
such as <code>memberof</code>.</p>

<blockquote>
  <p>Since this relationship uses virtual attributes, you cannot
  use <code>attach()</code> or <code>detach()</code> methods. This also means that
  for each entry that is contained in the virtual attribute,
  they will be queried for individually which can be very
  resource intensive depending on the group size.</p>
</blockquote>

<p>Lets define a <code>groups()</code> relationship that utilizes the <code>hasManyIn()</code> method:</p>

<pre><code class="language-php">&lt;?php

use LdapRecord\Models\Model;

class User extends Model
{
    public function groups()
    {
        return $this-&gt;hasManyIn(Group::class, 'memberof');
    }
}
</code></pre>

<h4>Important Note for Querying</h4>

<p>When using the above relationship from query results, you must ensure
you select the LDAP property you have defined as the <em>foreign key</em>
in the relationship. This attribute contains the values needed to
locate the related models.</p>

<p>For example, the following relationship query below will return no results
because we have explicitly requested attributes <strong>excluding</strong> <code>memberof</code>:</p>

<pre><code class="language-php">// Selecting only the 'cn', and 'sn' attributes:
$user = User::select(['cn', 'sn'])-&gt;find('cn=John Doe,dc=acme,dc=org');

// Returns an empty collection.
$groups = $user-&gt;groups()-&gt;get();
</code></pre>

<h2 id="querying-relationships">Querying Relationships</h2>

<p>LdapRecord relationships also serve as <a href="/docs/searching">query builders</a>.
This means you can chain query builder methods onto relationship methods to add
constraints to the relationship query prior to retrieving the results from
your directory.</p>

<p>For example, lets define a <code>User</code> model that can be a member of many groups:</p>

<pre><code class="language-php">&lt;?php

use App\Group;
use LdapRecord\Models\Model;

class User extends Model
{
    /**
     * Retrieve groups that the current user is apart of.
     */
    public function groups()
    {
        return $this-&gt;hasMany(Group::class, 'member');
    }
}
</code></pre>

<p>Now, lets retrieve a user's groups, but only return those groups that have a common name starting with 'Admin':</p>

<pre><code class="language-php">$user = User::find('cn=John Doe,dc=acme,dc=org');

$adminGroups = $user-&gt;groups()-&gt;whereStartsWith('cn', 'Admin')-&gt;get();
</code></pre>

<blockquote>
  <p>By default, querying relations will not include recursive results. More on this below.</p>
</blockquote>

<h3 id="recursive-queries">Recursive Queries</h3>

<p>To request all of the relationships results, such as nested groups in groups, call
the <code>recursive()</code> method, prior to retrieving results via <code>get()</code>:</p>

<pre><code class="language-php">$user = User::find('cn=John Doe,dc=acme,dc=org');

$allGroups = $user-&gt;groups()-&gt;recursive()-&gt;get();
</code></pre>

<blockquote>
  <p>Be careful when calling <code>recursive</code> on large sets of group memberships.
  If you are not careful, you could run out of memory due to thousands
  of models being returned.</p>
</blockquote>

<p>The <code>recursive</code> method sets a flag on the LdapRecord relationship indicating
you would like recursive results included (groups of groups).</p>

<p>Recursive results are gathered by first retrieving the groups that the user is
a member of, then retrieving the groups that are members of each resulting
parent group. This means an LDAP search query is executed for each group
that your user is apart of.</p>

<p>Circular group dependencies are rejected automatically to prevent infinite looping.</p>

<h2 id="attaching-amp-detatching-relationships">Attaching &amp; Detatching Relationships</h2>

<p>Using relationships you define, you can easily attach and detach related models from each other.
For example, you may want to attach a <code>Group</code> to a <code>User</code>, or vice-versa.</p>

<p>Using the above relationship examples, lets walk through this:</p>

<pre><code class="language-php">$user = User::find('cn=John Doe,dc=acme,dc=org');
$group = Group::find('cn=Accounting,dc=acme,dc=org');

// Attaching a group to a user:
$user-&gt;groups()-&gt;attach($user);

// Attaching a user to a group:
$group-&gt;members()-&gt;attach($user);
</code></pre>

<p>You may also use the <code>attachMany()</code> method to attach many models at once.</p>

<p>For this example, let's say we have an organizational unit that contains groups all new users must be apart of:</p>

<pre><code class="language-php">$ou = OrganizationalUnit::find('ou=Groups,dc=acme,dc=org');

$groups = Group::in($ou)-&gt;get();

$user = User::find('cn=John Doe,ou=Users,dc=acme,dc=org');

$user-&gt;groups()-&gt;attachMany($groups);
</code></pre>

<p>As you can see above, we took a complex LDAP operation and completed it in just 4 lines of code.</p>

<p>You may also want to detach a user from all groups, if for example they are
leaving the company and you it is apart of your off-boarding process.</p>

<p>You may accomplish this task by using the <code>detachAll()</code> method:</p>

<pre><code class="language-php">$user = User::find('cn=John Doe,ou=Users,dc=acme,dc=org');

$user-&gt;groups()-&gt;detachAll();
</code></pre>

<h2 id="checking-relationship-existence">Checking Relationship Existence</h2>

<p>To check if a model exists inside of a relationship, use the <code>exists()</code> relationship method.</p>

<blockquote>
  <p>If you're using Active Directory and are simply looking to check if a user is
  inside of a particular group, utilize the <code>Model::whereMemberOf</code> method
  that is available on all Active Directory models to locate users
  whom are members of that group.</p>
</blockquote>

<p>For example, lets determine if a <code>User</code> is a member of a <code>Group</code>:</p>

<pre><code class="language-php">$user = User::find('cn=John Doe,dc=acme,dc=org');
$group = Group::find('cn=Accounting,dc=acme,dc=org');

if ($user-&gt;groups()-&gt;exists($group)) {
    // This user is a member of the 'Accounting' group.
}
</code></pre>

<p>This method can be used on <strong>all</strong> relationship types.</p>

<p>For another example, lets determine if a <code>User</code> is a <code>manager</code> of another:</p>

<pre><code class="language-php">$user = User::find('cn=John Doe,dc=acme,dc=org');
$manager = User::find('cn=Jane Doe,dc=acme,dc=org');

if ($user-&gt;manager()-&gt;exists($manager)) {
    // Jane Doe is John Doe's manager.
}
</code></pre>

<p>You can also determine if the model has any groups or members by simply calling <code>exists()</code>:</p>

<pre><code class="language-php">$user = User::find('cn=John Doe,dc=acme,dc=org');

if ($user-&gt;manager()-&gt;exists()) {
    // This user has a manager.
}

if ($user-&gt;groups()-&gt;exists()) {
    // This user is a member of at least one group.
}
</code></pre>

                <div class="mt-12 pt-8 pb-6 border-t-2 border-purple-200">
                        <div class="flex flex-col-reverse md:flex-row justify-between items-center">
    <div class="flex flex-col items-center md:items-start">
                    <span class="font-black text-gray-500 text-sm tracking-wider uppercase pb-1">← Previous Topic</span>
            <h4 class="font-bold underline m-0 text-blue-700">
                <a href="/docs/models">Getting Started</a>
            </h4>
            </div>
    <div class="mb-8 md:mb-0 flex flex-col items-center md:items-end">
                    <span class="font-black text-gray-500 text-sm tracking-wider uppercase pb-1">Next Topic →</span>
            <h4 class="font-bold underline m-0 text-blue-700">
                <a href="/docs/model-mutators">Accessors & Mutators</a>
            </h4>
            </div>
</div>
                </div>

                <div class="mt-8 text-center hidden md:block">
                    <a class="font-black text-gray-500 text-sm tracking-wider uppercase" href="https://github.com/DirectoryTree/LdapRecord.com/blob/master/source//docs/model-relationships.md" target="_blank">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="w-6 h-6 inline-block fill-current mr-1">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path>
                        </svg>

                        Edit this Page
                    </a>
                </div>
            </div>
        </div>
    </section>
        </main>

        
        <script src="/assets/build/js/main.js?id=f26c1cfd7d5ee8790299"></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
            <script type="text/javascript">
            docsearch({
                apiKey: 'bc526397341486f980ca0b7ee7a0fa61',
                indexName: 'ldaprecord',
                inputSelector: '#docsearch-input',
                debug: false // Set debug to true if you want to inspect the dropdown
            });

            const searchInput = {
                toggle() {
                    const menu = document.getElementById('js-search-input');
                    menu.classList.toggle('hidden');
                    menu.classList.toggle('md:block');
                    document.getElementById('docsearch-input').focus();
                },
            }
        </script>
        </body>
</html>
